<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8' />
		<title></title>
		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.2.0/ol.css">
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Promise"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.2.0/ol.js"></script>
		<script src='js/olms.js'></script>
		<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.js'></script>
		<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.32.1/mapbox-gl.css' rel='stylesheet' />
		<style>
			body { margin:0; padding:0; }
			#map { position:absolute; top:0; bottom:0; width:100%; }
      #switch-libs{ position: absolute; bottom: 0px; right: 80px; }
      #switch-styles { position: absolute; bottom: 0px; left; 10px; }
      .switch-style { width: 50px; height: 50px; background: #ccc; opacity: 0.8; float: left; margin: 0 1em 0; text-align: center; font-size: 14px;padding: 1em;  cursor: pointer; border: 1px solid #cecece; border-bottom: none;}
      .switch-style.osm { background: #f7f6f1; }
      .switch-style.camo{ background: #576759; }
		</style>
	</head>
	<body>
	<div id='map'></div>
  <div id="switch-styles">
    <div class="switch-style camo" onClick="switchStyle('camo');">Camo</div>
    <div class="switch-style osm" onClick="switchStyle('mapbox');">OSM</div>
    <div class="switch-style osm" onClick="switchStyle('mobility');">Mobility</div>
    <div class="switch-style osm" onClick="switchStyle('night-vision3d');">Night Vision</div>
  </div>
  <div id="switch-libs">
    <div class="switch-style osm" onClick="switchLib(mapbox);">Mapbox GL</div>
    <div class="switch-style osm" onClick="switchLib(openlayers);">Open Layers 3</div>
  </div>
	<script>
    var map, currentLib;
    openLayersSatellite = new ol.layer.Tile({
                title: 'DigitalGlobe Maps API: Recent Imagery',
                source: new ol.source.XYZ({
                                    url: 'http://api.tiles.mapbox.com/v4/digitalglobe.nal0g75k/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGlnaXRhbGdsb2JlIiwiYSI6ImNqNWIyMHkxdzBmNGczNG55bGNhc2tlcncifQ.lQXsl-GCFgJWmIKEeaRpPg', // You will need to replace the 'access_token' and 'Map ID' values with your own. http://developer.digitalglobe.com/docs/maps-api
                attribution: "Â© DigitalGlobe, Inc"
                                })})
    var openlayers = {
      init: function() {
        map = olms.apply('map', '/styles/mapbox.json');
        map.getView().setCenter(ol.proj.fromLonLat([-117.15117725013909, 32.72269876352742]));
        map.getView().setZoom(15);
      },
      switchStyle: function(style) {
        map.getLayers().getArray().forEach(function(layer) {
          map.removeLayer(layer);
        });
        map = olms.apply(map, '/styles/'+style+'.json');
        if(style === 'night-vision3d') {
          map.addLayer(openLayersSatellite);
        }
      }
    }
    mapboxgl.accessToken = 'pk.eyJ1IjoiamowaG5zMG4iLCJhIjoiY2o1YjRtMjZpMGd2MDJ3bW00bnA5NXdyMiJ9.qlR4a_qfTlKZs1Qisk6sAg';
    var mapbox = {
      init: function() {
        map = new mapboxgl.Map({
          container: 'map', // container id
          style: '/styles/mapbox.json',
          center: [-117.15117725013909, 32.72269876352742], 
          zoom: 15,
          hash: true 
        });
        map.addControl(new mapboxgl.NavigationControl());
      },
      switchStyle: function(style) {
        map.setStyle('/styles/'+style+'.json');
        if(style === 'night-vision3d') {
        }
      }
    };
    var switchLib = function(lib) {
      currentLib = lib;
      document.getElementById('map').innerHTML = '';
      lib.init();
    }
    var switchStyle = function(style) {
      currentLib.switchStyle(style);
    }
    currentLib = mapbox;
    mapbox.init();
	</script>
	</body>
</html>
